package o_auth

// This file was generated by the swagger tool.
// Editing this file might prove futile when you re-run the swagger generate command

import (
	"github.com/go-openapi/runtime"

	strfmt "github.com/go-openapi/strfmt"
)

// New creates a new o auth API client.
func New(transport runtime.ClientTransport, formats strfmt.Registry) *Client {
	return &Client{transport: transport, formats: formats}
}

/*
Client for o auth API
*/
type Client struct {
	transport runtime.ClientTransport
	formats   strfmt.Registry
}

/*
DeleteCredentialsID deletes an o auth credential pair

Delete an OAuth 2.0 credential pair.

Can only be called through [Grafton's credentials command](https://github.com/manifoldco/grafton)
in the context of a Manifold user.

*/
func (a *Client) DeleteCredentialsID(params *DeleteCredentialsIDParams, authInfo runtime.ClientAuthInfoWriter) (*DeleteCredentialsIDNoContent, error) {
	// TODO: Validate the params before sending
	if params == nil {
		params = NewDeleteCredentialsIDParams()
	}

	result, err := a.transport.Submit(&runtime.ClientOperation{
		ID:                 "DeleteCredentialsID",
		Method:             "DELETE",
		PathPattern:        "/credentials/{id}",
		ProducesMediaTypes: []string{"application/json"},
		ConsumesMediaTypes: []string{"application/json"},
		Schemes:            []string{"https"},
		Params:             params,
		Reader:             &DeleteCredentialsIDReader{formats: a.formats},
		AuthInfo:           authInfo,
		Context:            params.Context,
		Client:             params.HTTPClient,
	})
	if err != nil {
		return nil, err
	}
	return result.(*DeleteCredentialsIDNoContent), nil

}

/*
GetCredentials gets list of o auth credentials without secrets

List all non-expired OAuth 2.0 credential pairs for a provider's product.

One of the `product_id` or `provider_id` query parameters is required.

**IMPORTANT**: This does **not** return the secret.

Can only be called through [Grafton's credentials command](https://github.com/manifoldco/grafton)
in the context of a Manifold user.

*/
func (a *Client) GetCredentials(params *GetCredentialsParams, authInfo runtime.ClientAuthInfoWriter) (*GetCredentialsOK, error) {
	// TODO: Validate the params before sending
	if params == nil {
		params = NewGetCredentialsParams()
	}

	result, err := a.transport.Submit(&runtime.ClientOperation{
		ID:                 "GetCredentials",
		Method:             "GET",
		PathPattern:        "/credentials/",
		ProducesMediaTypes: []string{"application/json"},
		ConsumesMediaTypes: []string{"application/json"},
		Schemes:            []string{"https"},
		Params:             params,
		Reader:             &GetCredentialsReader{formats: a.formats},
		AuthInfo:           authInfo,
		Context:            params.Context,
		Client:             params.HTTPClient,
	})
	if err != nil {
		return nil, err
	}
	return result.(*GetCredentialsOK), nil

}

/*
GetSelf currents identity

A provider can call this endpoint to return the identity represented by
the access token.

Depending on the grant type used to create an access token the
underlying identity will be different.

| Grant Type | Identity Type |
| ---------- | ------------ |
| `authorization_code` | `user` |
| `client_credentials` | `product` or `provider` |

*/
func (a *Client) GetSelf(params *GetSelfParams, authInfo runtime.ClientAuthInfoWriter) (*GetSelfOK, error) {
	// TODO: Validate the params before sending
	if params == nil {
		params = NewGetSelfParams()
	}

	result, err := a.transport.Submit(&runtime.ClientOperation{
		ID:                 "GetSelf",
		Method:             "GET",
		PathPattern:        "/self",
		ProducesMediaTypes: []string{"application/json"},
		ConsumesMediaTypes: []string{"application/json"},
		Schemes:            []string{"https"},
		Params:             params,
		Reader:             &GetSelfReader{formats: a.formats},
		AuthInfo:           authInfo,
		Context:            params.Context,
		Client:             params.HTTPClient,
	})
	if err != nil {
		return nil, err
	}
	return result.(*GetSelfOK), nil

}

/*
PostCredentials creates an o auth credential pair

Create an OAuth 2.0 credential pair for a provider.

That credential can either be scoped to all products of the provider
or to a specific product. This is done by providing the `product_id`.

`client_secret` is stored as an `scrypt` hash only. Therefore, If the
value is lost after creation, it cannot be recovered.

**IMPORTANT**: For security, Manifold expires all previously created
credentials of the same scope (product or provider) within 24 hours
of creating a new credential. This means that only the most recent
credential of a specific scope should be used.

Can only be called through [Grafton's credentials command](https://github.com/manifoldco/grafton)
in the context of a Manifold user.

*/
func (a *Client) PostCredentials(params *PostCredentialsParams, authInfo runtime.ClientAuthInfoWriter) (*PostCredentialsOK, error) {
	// TODO: Validate the params before sending
	if params == nil {
		params = NewPostCredentialsParams()
	}

	result, err := a.transport.Submit(&runtime.ClientOperation{
		ID:                 "PostCredentials",
		Method:             "POST",
		PathPattern:        "/credentials/",
		ProducesMediaTypes: []string{"application/json"},
		ConsumesMediaTypes: []string{"application/json"},
		Schemes:            []string{"https"},
		Params:             params,
		Reader:             &PostCredentialsReader{formats: a.formats},
		AuthInfo:           authInfo,
		Context:            params.Context,
		Client:             params.HTTPClient,
	})
	if err != nil {
		return nil, err
	}
	return result.(*PostCredentialsOK), nil

}

/*
PostOauthTokens creates access token

A provider uses this endpoint to acquire a scoped access token which
grants them authority to act on behalf of the grantor (either a
provider or user).

There are two grant types used for requesting an access token:

* `authorization_code` which allows a provider to exchange a `code`
  grant from a user for an access token giving them permission to act on
  the user's behalf.
* `client_credentials` which allows a provider to grant themselves an
  access token that is either scoped to all their products or to
  a specific one.

This endpoint is a part of the Single Sign-On flow invoked by users
attempting to navigate to a resource's dashboard. A `code` is only
valid for five minutes and cannot be used more than once to grant an
access token.

Provider authentication is supported with `client_id` and
`client_secret` in either the request body, or via basic authentication.
Basic authentication is the preferred method, but is not required.

The granted token will expire within 24 hours.

*/
func (a *Client) PostOauthTokens(params *PostOauthTokensParams) (*PostOauthTokensCreated, error) {
	// TODO: Validate the params before sending
	if params == nil {
		params = NewPostOauthTokensParams()
	}

	result, err := a.transport.Submit(&runtime.ClientOperation{
		ID:                 "PostOauthTokens",
		Method:             "POST",
		PathPattern:        "/oauth/tokens",
		ProducesMediaTypes: []string{"application/json"},
		ConsumesMediaTypes: []string{"application/json", "application/x-www-form-urlencoded"},
		Schemes:            []string{"https"},
		Params:             params,
		Reader:             &PostOauthTokensReader{formats: a.formats},
		Context:            params.Context,
		Client:             params.HTTPClient,
	})
	if err != nil {
		return nil, err
	}
	return result.(*PostOauthTokensCreated), nil

}

// SetTransport changes the transport on the client
func (a *Client) SetTransport(transport runtime.ClientTransport) {
	a.transport = transport
}
